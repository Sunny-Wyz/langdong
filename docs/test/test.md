# 基础数据管理系统 - 新增功能验收指南

本系统已新增了“货位档案管理”、“设备档案管理”、“供应商档案管理”以及**备件 8 位统一编码体系**等核心功能模块，均已完整开发并覆盖从数据库建表至前端页面的全链路。

以下是相关功能的详细验证方式说明：

## 一、货位档案管理、设备档案管理、供应商档案管理
这些都是历史验收过的模块，具体验证流程可以继续通过左侧基础数据管理的各个对应页面进行联动与测试。

---

## 二、备件档案 8位统一编码体系与“一物一码”

### 1. 系统变更范围
1. **数据库层**: 
   - 彻底清空了旧有混乱的测试备件数据。
   - 建立了 `spare_part_category` 供维护5大类和30多种小类的字典映射树，并在系统启动时自动导入了基础数据种子。
   - `spare_part` 增加了 `code` 等核心识别字段以及针对字典表的外键连接。
2. **后端发号器**:
   - `SparePartController` 保存时会检索对应的4位大、小类代码；搜索该开头前缀在已有库中最大的后四位流水编号；自动 +1 补零组合后保存入库。强制保障“一物一码”。
3. **前端层**:
   - 备件表格新增了第一列“**备件编码 (8位数)**”。
   - “添加/编辑”表单将原有的全手写文本框变更为了**分组联动的下拉框选择组件（根据五大门类汇总组合显示对应的规格明细和4位分类码）**。系统创建时不允许用户碰编码，由后台统一按规则计算出结果并返显给列表和编辑模式。

### 2. 验证步骤
1. **重启并返回主界面**：等我通知后，强制刷新您的浏览器（`Cmd/Ctrl + Shift + R`）读取最新的前端组件。由于我们在底层完全重置并清空了备件库历史表，所以此时您的备件列表应当是干干净净的。
2. **创建首台设备**：点击表格上方的“增加备件”。
3. **分配分类明细**：在“类别”一栏打开下拉列表，您会看见分好组的“五金类”、“机械类”、“润滑类”等大区块，并且各自下方有“轴承 (2001)”、“润滑油 (5001)”这样的二级子规。
4. **触发系统发号**：随机挑选一个类别（比如“机械类 -> 轴承”），填入其他属性保存即可。
5. **验证流水自增规则**：
   - 刚刚创建的一条备件由于是首件，它的“备件编码”应当是类似 `20010001`。
   - 马上**再创建一条**依然属于“轴承”的备件，点保存，观察它的编码应该会自动累加进位为 `20010002`，验证发号器功能是否准确。
   - 创建一条属于“电气类 -> 电机类”的备件，发现其分类编码首码不同，且流水号从自己的 `0001` 开始即 `30010001`。
6. **防篡改验证**：尝试点击某条编辑。备件编码应该在上方通过只读灰色输入框展示出来，不能随意被前端操作破坏唯一性。

---

## 三、系统认证与 RBAC 权限管理

我们在系统中已经实现了基于 RBAC（基于角色的访问控制）权限的完整后端体系与前端动态交互，并已替换掉了之前仅靠静态路由硬编码的侧边栏。现在您可以按照以下步骤亲自体验验证：

### 1. 登录管理员账号检视功能
- **账号**: `admin`
- **密码**: `123456`
- **预期结果**: 系统启动后进入首页，左侧边栏不再是写在 Vue 里的静态死代码，而是从数据库实时拉取的（由于默认 admin 分配了“超级管理员”角色，所以您能看到所有全量的“系统管理”与“基础数据管理”等菜单）。

### 2. 体验用户与角色管理功能面板
- [展开系统管理] 面板，点击 **用户管理**：
    - 在右上角点击 `新增用户` 按钮，随意起一个 `test1` 用户（系统后端会默认赋予这个用户初始密码为 `123456`）。
- 点击 **角色与菜单分配**：
    - 点击右上角 `新增角色`，创建一个自定义角色，比如编码起名为 `INVENT_USER`，名称写成“库管查阅员”。
    - 点一下新增出来的角色的绿色按钮（“权限分配”）。
    - 屏幕中央弹出一棵树，**请只勾选** `基础数据管理` 和它底下的 `备件档案管理`，**不勾选** 系统管理 等功能。保存设置。

### 3. 进行“给测试员分配角色”并测试
- 切回 **用户管理**。
- 对准刚才由您建立的 `test1` 用户，点击绿色按钮（分配角色），在弹出的框里**只勾好**新建立的“库管查阅员”。
- 点击页面右上角您的名字，下拉点击 **[退出登录]**。
- 输入刚刚的这号账号密码 `test1` / `123456` 登入。
- **预期结果**：您将发现左侧导航边栏**变得很干净**，只能看见您在刚才那颗树上勾选的菜单视图，成功实现了无侵入的页级别功能拦阻！
